import{r as n,A as I,b as D,S as G,c as P,j as e,a as x,y as h,s as R,d as A,p as U}from"./index-HS-0_6p7.js";import{a as q,b as $,c as z}from"./index-BTT9Qpdf.js";import{H}from"./Helmet-BQrkXuiA.js";import{m as d}from"./proxy-4A12_6Dc.js";import{C as N}from"./ClipLoader-BU5QXpBz.js";const M=()=>{const{userData:T,setToken:u,token:f}=n.useContext(I),r=D();let C=window.location.pathname==="/register";const[t,k]=n.useState(!!C),{backendurl:g}=n.useContext(G),[S,y]=n.useState(!1),[j,w]=n.useState(!1),[L]=P(),l=L.get("ref")||null;console.log("referralCode",l),n.useEffect(()=>{f&&r("/")},[f]);const[s,b]=n.useState({name:"",email:"",password:""}),p=o=>{const{name:a,value:i}=o.target;b(c=>({...c,[a]:i}))};console.log({referralCode:l});const E=async o=>{o.preventDefault();try{if(y(!0),t){let a=await x.post(`${g}/api/user/register`,{name:s.name,email:s.email,password:s.password,referralCode:l});h.success(a.data.message),u(a.data.token),localStorage.setItem("token",a.data.token),r("/")}else{let a=await x.post(`${g}/api/user/login`,{email:s.email,password:s.password});a.data.success?(r("/"),h.success(a.data.message),u(a.data.token),localStorage.setItem("token",a.data.token),r("/")):h.error(a.data.message)}}catch{}finally{y(!1),b({name:"",email:"",password:""})}},F=async()=>{try{w(!0);const o=await R(A,U),{displayName:a,email:i,photoURL:c,uid:v}=o.user;console.log("data that get from response",{displayName:a,email:i,photoURL:c,uid:v,referralCode:l});const m=await x.post(`${g}/api/user/google-auth`,{googleId:v,name:a,email:i,avatar:c,referralCode:l});console.log(m.data),m.data.success&&(u(m.data.token),localStorage.setItem("token",m.data.token),r("/"))}catch(o){console.log(o)}finally{w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsxs("title",{children:[t?"Sign Up":"Login"," | E-commerce"]}),e.jsx("meta",{name:"description",content:t?"Create an account to start shopping on our E-commerce platform.":"Login to your E-commerce account to continue shopping."})]}),e.jsx("div",{className:"flex items-start justify-center min-h-screen pt-20 px-1 sm:px-0 ",children:e.jsxs(d.div,{className:"w-full max-w-sm p-6 rounded-xl text-gray-700",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(d.h2,{className:"text-xl font-bold mb-6 text-center",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.2},children:t?"Create Account":"Welcome Back"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[t&&e.jsxs(d.div,{className:"relative",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:[e.jsx(q,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-gray-400"}),e.jsx("input",{type:"text",name:"name",placeholder:"Full Name",required:!0,value:s.name,onChange:p,className:"w-full pl-10 pr-4 py-2 text-sm border rounded-lg outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-gray-400"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email",autoComplete:"email",required:!0,value:s.email,onChange:p,className:"w-full pl-10 pr-4 py-2 text-sm border rounded-lg outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-gray-400"}),e.jsx("input",{type:"password",name:"password",placeholder:"Password",autoComplete:"current-password",required:!0,value:s.password,onChange:p,className:"w-full pl-10 pr-4 py-2 text-sm border rounded-lg outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx(d.button,{type:"submit",className:"w-full py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg hover:bg-indigo-500 transition",whileTap:{scale:.97},children:S?e.jsx(N,{size:20,color:"white"}):t?"Sign up":"Login"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:[t?"Already have an account?":"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>k(!t),className:"text-indigo-600 hover:underline font-medium",children:t?"Login":"Sign up"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("div",{className:"h-px bg-gray-300 flex-1"}),e.jsx("span",{className:"text-xs text-gray-400",children:"OR"}),e.jsx("div",{className:"h-px bg-gray-300 flex-1"})]}),e.jsxs("button",{type:"button",onClick:F,className:"w-full mt-4 py-2 flex items-center justify-center gap-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition",children:[!j&&e.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:j?e.jsx(N,{size:20}):"Continue with Google"})]})]})})]})};export{M as default};
