import{r,A as G,b as R,S as A,c as D,j as e,a as h,y as c,s as q,d as U,p as $}from"./index-CYHhhT0N.js";import{a as z,b as H,c as T,d as W,e as B}from"./index-BWKLkC9W.js";import{H as O}from"./Helmet-BY_zfl5y.js";import{a as J}from"./assets-CHJEBLat.js";import{m}from"./proxy-DKRBUN5K.js";import{C as v}from"./ClipLoader-B_PNeP9i.js";const _=()=>{const[f,N]=r.useState(!1),{userData:K,setToken:u,token:b}=r.useContext(G),n=R();let S=window.location.pathname==="/register";const[s,C]=r.useState(!!S),{backendurl:d}=r.useContext(A),[E,y]=r.useState(!1),[w,k]=r.useState(!1),[L]=D(),j=L.get("ref")||null;r.useEffect(()=>{b&&n("/")},[b,n]);const[o,g]=r.useState({name:"",email:"",password:""}),p=t=>{const{name:l,value:i}=t.target;g(a=>({...a,[l]:i}))},P=async t=>{var l,i;t.preventDefault(),t.target.querySelectorAll("input").forEach(a=>a.blur());try{if(y(!0),s){let a=await h.post(`${d}/api/user/register`,{name:o.name,email:o.email,password:o.password,referralCode:j});a.data.success?(c.success(a.data.message),u(a.data.token),localStorage.setItem("token",a.data.token),g({name:"",email:"",password:""}),n("/"),n("/")):c.error(a.data.message)}else{let a=await h.post(`${d}/api/user/login`,{email:o.email,password:o.password});a.data.success?(c.success(a.data.message),u(a.data.token),localStorage.setItem("token",a.data.token),g({name:"",email:"",password:""}),n("/")):c.error(a.data.message)}}catch(a){console.log(a),c.error(((i=(l=a.response)==null?void 0:l.data)==null?void 0:i.message)||"Network error, please try again.")}finally{y(!1)}},F=async()=>{try{k(!0);const t=await q(U,$),{displayName:l,email:i,photoURL:a,uid:I}=t.user,x=await h.post(`${d}/api/user/google-auth`,{googleId:I,name:l,email:i,avatar:a,referralCode:j});x.data.success&&(u(x.data.token),localStorage.setItem("token",x.data.token),n("/"))}catch(t){console.log(t),c.error("Google login failed. Please try again.")}finally{k(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsxs("title",{children:[s?"Sign Up":"Login"," | E-commerce"]}),e.jsx("meta",{name:"description",content:s?"Create an account to start shopping on our E-commerce platform.":"Login to your E-commerce account to continue shopping."})]}),e.jsx("div",{className:"flex items-start justify-center min-h-screen pt-20 px-1 sm:px-0",style:{backgroundImage:`url(${J.loginbg})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:e.jsxs(m.div,{className:"w-full max-w-sm p-6 rounded-xl text-gray-700 bg-white bg-opacity-90 shadow-lg",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(m.h2,{className:"text-xl font-bold mb-6 text-center",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.2},children:s?"Create Account":"Welcome Back"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[s&&e.jsxs(m.div,{className:"relative",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:[e.jsx(z,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-black group-focus-within:text-black transition"}),e.jsx("input",{type:"text",name:"name",placeholder:"Full Name",required:!0,value:o.name,onChange:p,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-black focus:border-black transition duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-black group-focus-within:text-black transition"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email",autoComplete:"email",required:!0,value:o.email,onChange:p,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-black focus:border-black transition duration-200"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(T,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-black group-focus-within:text-black transition"}),e.jsx("input",{type:f?"text":"password",name:"password",placeholder:"Password",autoComplete:"current-password",required:!0,value:o.password,onChange:p,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-black focus:border-black transition duration-200"}),e.jsx("button",{type:"button",onClick:()=>N(t=>!t),className:"absolute top-1/2 right-3 -translate-y-1/2 text-black hover:text-black transition",children:f?e.jsx(W,{}):e.jsx(B,{})})]}),e.jsx(m.button,{type:"submit",className:"w-full py-2 text-sm font-semibold text-white bg-black rounded-lg hover:bg-gray-900 transition",whileTap:{scale:.97},children:E?e.jsx(v,{size:20,color:"white"}):s?"Sign up":"Login"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:[s?"Already have an account?":"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>C(!s),className:"text-black hover:underline font-medium",children:s?"Login":"Sign up"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("div",{className:"h-px bg-gray-300 flex-1"}),e.jsx("span",{className:"text-xs text-gray-400",children:"OR"}),e.jsx("div",{className:"h-px bg-gray-300 flex-1"})]}),e.jsxs("button",{type:"button",onClick:F,className:"w-full mt-4 py-2 flex items-center justify-center gap-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition",children:[!w&&e.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:w?e.jsx(v,{size:20}):"Continue with Google"})]})]})})]})};export{_ as default};
