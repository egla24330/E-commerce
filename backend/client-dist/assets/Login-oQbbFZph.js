import{r,A as R,b as T,S as A,d as $,j as e,a as p,y as n,s as q,e as z,p as U}from"./index-BQSgFZ4m.js";import{a as H,b as W,c as B,d as O,e as _}from"./index-Cbnh4brd.js";import{H as J}from"./Helmet-3N7p5rxb.js";import{a as N}from"./assets-nNy7GWIk.js";import{m as x}from"./proxy-BTJl8b6m.js";import{C as w}from"./ClipLoader-DauM1FJ0.js";const ee=()=>{const[j,C]=r.useState(!1),{userData:K,setToken:m,token:k}=r.useContext(R),l=T();let S=window.location.pathname==="/register";const[s,L]=r.useState(!!S),{backendurl:d}=r.useContext(A),[E,v]=r.useState(!1),[u,g]=r.useState(!1),[P]=$(),h=P.get("ref")||null;r.useEffect(()=>{k&&l("/")},[k,l]);const[o,f]=r.useState({name:"",email:"",password:""}),y=t=>{const{name:i,value:c}=t.target;f(a=>({...a,[i]:c}))},F=async t=>{var i,c;t.preventDefault(),t.target.querySelectorAll("input").forEach(a=>a.blur());try{if(v(!0),s){let a=await p.post(`${d}/api/user/register`,{name:o.name,email:o.email,password:o.password,referralCode:h});a.data.success?(n.success(a.data.message),m(a.data.token),localStorage.setItem("token",a.data.token),f({name:"",email:"",password:""}),l("/"),l("/")):n.error(a.data.message)}else{let a=await p.post(`${d}/api/user/login`,{email:o.email,password:o.password});a.data.success?(n.success(a.data.message),m(a.data.token),localStorage.setItem("token",a.data.token),f({name:"",email:"",password:""}),l("/")):n.error(a.data.message)}}catch(a){console.log(a),n.error(((c=(i=a.response)==null?void 0:i.data)==null?void 0:c.message)||"Network error, please try again.")}finally{v(!1)}},I=async()=>{try{g(!0);const t=await q(z,U),{displayName:i,email:c,photoURL:a,uid:G}=t.user,b=await p.post(`${d}/api/user/google-auth`,{googleId:G,name:i,email:c,avatar:a,referralCode:h});b.data.success&&(m(b.data.token),localStorage.setItem("token",b.data.token),l("/"))}catch(t){console.log(t),n.error("Google login failed. Please try again.")}finally{g(!1)}},D=async()=>{try{g(!0);const t=await p.post(`${d}/api/user/telegram-login`,{initData,referralCode:h});t.data.success?(m(t.data.token),localStorage.setItem("token",t.data.token),l("/")):n.error(t.data.message||"Telegram login failed. Please try again.")}catch(t){console.log(t),n.error("Telegram login failed. Please try again.")}finally{g(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(J,{children:[e.jsxs("title",{children:[s?"Sign Up":"Login"," | E-commerce"]}),e.jsx("meta",{name:"description",content:s?"Create an account to start shopping on our E-commerce platform.":"Login to your E-commerce account to continue shopping."})]}),e.jsx("div",{className:"flex items-start justify-center min-h-screen pt-20 px-1 sm:px-0 ",style:{backgroundImage:`url(${N.loginbg})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:e.jsxs(x.div,{className:"w-full  max-w-md p-6 rounded-xl text-gray-700 bg-white bg-opacity-90 shadow-lg ",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(x.h2,{className:"text-xl font-bold mb-6 text-center",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.2},children:s?"Create Account":"Welcome Back"}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[s&&e.jsxs(x.div,{className:"relative",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:[e.jsx(H,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-black group-focus-within:text-black transition"}),e.jsx("input",{type:"text",name:"name",placeholder:"Full Name",required:!0,value:o.name,onChange:y,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-700 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-black focus:border-black transition duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-black group-focus-within:text-black transition"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email",autoComplete:"email",required:!0,value:o.email,onChange:y,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-700 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-black focus:border-black transition duration-200"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(B,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-black group-focus-within:text-black transition"}),e.jsx("input",{type:j?"text":"password",name:"password",placeholder:"Password",autoComplete:"current-password",required:!0,value:o.password,onChange:y,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-700 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-black focus:border-black transition duration-200"}),e.jsx("button",{type:"button",onClick:()=>C(t=>!t),className:"absolute top-1/2 right-3 -translate-y-1/2 text-black hover:text-black transition",children:j?e.jsx(O,{}):e.jsx(_,{})})]}),e.jsx(x.button,{type:"submit",className:"w-full py-2 text-sm font-semibold text-white bg-black rounded-lg hover:bg-gray-900 transition",whileTap:{scale:.97},children:E?e.jsx(w,{size:20,color:"white"}):s?"Sign up":"Login"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:[s?"Already have an account?":"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>L(!s),className:"text-black hover:underline font-medium",children:s?"Login":"Sign up"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("div",{className:"h-px bg-gray-300 flex-1"}),e.jsx("span",{className:"text-xs text-gray-400",children:"OR"}),e.jsx("div",{className:"h-px bg-gray-300 flex-1"})]}),e.jsxs("button",{type:"button",onClick:I,className:"w-full mt-4 py-2 flex items-center justify-center gap-3 border border-gray-700 rounded-lg hover:bg-gray-100 transition",children:[!u&&e.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:u?e.jsx(w,{size:20}):"Continue with Google"})]}),e.jsxs("button",{type:"button",onClick:D,className:"w-full mt-4 py-2 flex items-center justify-center gap-3 border border-gray-700 rounded-lg hover:bg-gray-100 transition",children:[!u&&e.jsx("img",{src:N.tg_icon,alt:"Telegram",width:"25",height:"25"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:u?e.jsx(w,{size:20}):"Continue with telegram"})]})]})})]})};export{ee as default};
