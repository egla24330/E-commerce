import{c as S,r,S as F,A as U,j as e,a as b,y as a}from"./index-COKxKe4A.js";import{R as D}from"./ReceiptSuccessModal-Dw__n2cB.js";import{H}from"./Helmet-CQML1vgr.js";import{C}from"./ClipLoader-B7c-mFyc.js";import{U as R}from"./user-DV3bq2i1.js";import{M as Z}from"./mail-DUFJoDdN.js";import"./index-BPNraHqv.js";import"./index-B4jthjwr.js";import"./proxy-Dkt98RHx.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],_=S("gift",T);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],V=S("share-2",J),le=()=>{const{backendurl:n}=r.useContext(F),{token:u}=r.useContext(U),[m,A]=r.useState(!1),[l,E]=r.useState(0),[i,L]=r.useState(""),[x,W]=r.useState(""),[w,y]=r.useState(!1),[q,j]=r.useState(!0),[N,P]=r.useState(""),[h,v]=r.useState(!1),[s,I]=r.useState(null),[o,$]=r.useState(0),[c,z]=r.useState(""),[M,k]=r.useState(!1);r.useEffect(()=>{l<999?v(!0):v(!1)},[l]);const p=async()=>{j(!0);try{const t=await b.post(`${n}/api/user/me`,{},{headers:{token:u}});console.log("User data fetched:",t),t.data.success===!0?(I(t.data.userData),P(t.data.userData._id),$(t.data.userData.coins)):a.error("Failed to fetch user data")}catch(t){a.error("Error fetching user data"),console.error("Error fetching user data:",t)}finally{j(!1)}};r.useEffect(()=>{p()},[u,n]);const g=s!=null&&s.referralCode?`${window.location.origin}/register?ref=${s.referralCode}`:"",X=async()=>{try{navigator.share?await navigator.share({title:"Join zaycommerce",text:"Join zaycommerce and get exclusive benefits!",url:g}):(await navigator.clipboard.writeText(g),a.success("Invite link copied to clipboard!"))}catch(t){a.error("Failed to share invite link."),console.error(t)}};let B=async()=>{let t=a.loading("Processing withdrawal request...");if(!c.trim()||!/^09\d{8}$/.test(c)){a.error("Enter a valid Ethiopian phone number (e.g., 09XXXXXXXX)"),a.update(t,{render:"Invalid phone number",type:"error",isLoading:!1,autoClose:3e3});return}if(!i.trim()||i.length<6){a.error("Enter a valid Bank Account Number"),a.update(t,{render:"Invalid bank account number",type:"error",isLoading:!1,autoClose:3e3});return}if(h){a.error("Minimum withdrawal amount is 999 coin."),a.update(t,{render:"Minimum withdrawal amount not met",type:"error",isLoading:!1,autoClose:3e3});return}else if(l>o){a.error("You cannot withdraw more than your current balance."),a.update(t,{render:"Insufficient balance",type:"error",isLoading:!1,autoClose:3e3});return}y(!0);try{let d=o-l;if((await b.post(`${n}/api/withdrawal/withdrawal-update`,{coin:d},{headers:{token:u}})).data.success){const f=await b.post(`${n}/api/withdrawal/withdrawal-request`,{withdrawalAmount:l,bankAccount:i,name:x,userId:N,phone:c,leftDeposite:d});f.data.success?(p(),a.update(t,{render:"Withdrawal request submitted successfully!",type:"success",isLoading:!1,autoClose:3e3}),k(!0)):(a.error(f.data.message),a.update(t,{render:f.data.message,type:"error",isLoading:!1,autoClose:3e3}))}else a.error("Something went wrong"),a.update(t,{render:"Failed to update coins",type:"error",isLoading:!1,autoClose:3e3})}catch(d){console.error(d),p(),a.update(t,{render:"Error processing withdrawal request",type:"error",isLoading:!1,autoClose:3e3})}finally{y(!1)}};return q?e.jsxs("div",{className:"flex justify-center items-center h-[70vh] gap-2",children:[e.jsx(C,{color:"#4F46E5",size:30})," ",e.jsx("p",{children:"loading user data ....."})]}):s?e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx("title",{children:"Profile | zaycommerce"}),e.jsx("meta",{name:"description",content:"View and manage your zaycommerce profile, check your ZCoins balance, invite friends, and request withdrawals."}),e.jsx("meta",{name:"robots",content:"index, follow"}),e.jsx("meta",{property:"og:title",content:"Profile | zaycommerce"}),e.jsx("meta",{property:"og:description",content:"View and manage your zaycommerce profile, check your ZCoins balance, invite friends, and request withdrawals."}),e.jsx("meta",{property:"og:url",content:"https://www.zaycommerce.com/profile"}),e.jsx("meta",{property:"og:type",content:"profile"})]}),e.jsxs("div",{className:"max-w-3xl mx-auto mt-10 p-1 sm:p-3 bg-white shadow-lg rounded-2xl border border-gray-200 space-y-6",children:[e.jsxs("div",{className:"flex flex-column items-center gap-4",children:[s.avatar?e.jsx("img",{src:s.avatar,alt:"User Avatar",className:"w-12 h-12 rounded-full"}):e.jsxs("div",{className:"flex items-center justify-center bg-red-100 w-[50px] h-[50px] rounded-full",children:[" ",e.jsx(R,{className:"w-6 h-6 text-indigo-600"})," "]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Welcome to your profile"})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-indigo-500"}),e.jsx("span",{children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("span",{children:["ZCoins: ",e.jsx("strong",{children:s.coins})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-xl",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("p",{className:"text-indigo-700 font-medium",children:"🎁 Invite friends"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("button",{onClick:X,className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition",children:[e.jsx(V,{className:"w-4 h-4"}),"Share"]}),e.jsx("span",{className:"text-sm text-gray-500 break-all",children:g})]})]}),e.jsx("button",{onClick:()=>A(!m),className:"mt-4 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:m?"Cancel Withdrawal":"Request Withdrawal"}),m&&e.jsxs("div",{className:`mt-4 p-4 rounded-xl border ${h?"bg-red-50":"bg-green-50"} ${o<l?"bg-red-200":"bg-200"}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Withdrawal Request"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter your bank account details to request a withdrawal."}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 font-extrabold",children:"1 ZCoins = 0.25 ETB"}),h&&e.jsx("p",{className:"text-red-600 text-sm mb-4",children:"Minimum withdrawal amount is 999 ZCoins."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"w-full p-1 ",children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-2",children:"Withdrawal Amount (in ZCoins)"}),e.jsx("input",{type:"number",placeholder:"Withdrawal Amount",onChange:t=>E(Number(t.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg mb-3"})]}),e.jsxs("div",{className:"w-full p-1 ",children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-2",children:"ETB"}),e.jsx("input",{type:"text",placeholder:"Withdrawal Amount",value:l*.25+" ETB",disabled:!0,className:"w-full p-2 border border-gray-300 rounded-lg mb-3"})]}),e.jsxs("div",{className:"w-full p-1 ",children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-2",children:"Balance"}),e.jsx("input",{type:"number",placeholder:"😠😠😠😠",disabled:!0,value:o<l?"Insufficient":o-l,className:"w-full p-2 border border-gray-300 rounded-lg mb-3"})]})]}),e.jsxs("div",{className:"w-full p-1",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Account Holder Name"}),e.jsx("input",{onChange:t=>W(t.target.value),type:"text",placeholder:"Account Holder Name",className:"w-full p-2 border border-gray-300 rounded-lg mb-3"})]}),e.jsxs("div",{className:"w-full p-1 ",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"id"}),e.jsx("input",{type:"text",value:N,disabled:!0,className:"w-full p-2 border border-gray-300 rounded-lg mb-3"})]}),e.jsxs("div",{className:"w-full p-1 ",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",placeholder:"Phone Number",value:c,onChange:t=>z(t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg mb-3"})]}),e.jsx("input",{type:"text",placeholder:"Bank Account Number",value:i,onChange:t=>L(t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg mb-3"}),e.jsx("button",{onClick:B,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",disabled:w,children:w?e.jsx(C,{color:"#ffffff",size:20}):"Submit Withdrawal Request"})]})]}),e.jsx(D,{show:M,onClose:()=>k(!1),p1:`Hi ${x||"User"}, Your withdrawal request has been successfully submitted. Please wait for the processing time to complete.`,p2:"Thank you for your patience!"})]}):e.jsx("div",{className:"p-6 text-center text-red-600",children:"Failed to load profile data. Please try again."})};export{le as default};
