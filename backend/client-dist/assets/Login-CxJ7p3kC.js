import{r as n,A as I,b as A,S as D,c as R,j as e,a as h,y as c,s as q,d as U,p as $}from"./index-D_AtKwXT.js";import{a as z,b as H,c as T,d as W,e as B}from"./index-Cf-NmoxF.js";import{H as O}from"./Helmet-C63Otn-q.js";import{m as d}from"./proxy-B03JueXb.js";import{C as N}from"./ClipLoader-CRyFY4x6.js";const Y=()=>{const[f,C]=n.useState(!1),{userData:J,setToken:m,token:y}=n.useContext(I),r=A();let S=window.location.pathname==="/register";const[s,k]=n.useState(!!S),{backendurl:u}=n.useContext(D),[E,w]=n.useState(!1),[b,j]=n.useState(!1),[L]=R(),v=L.get("ref")||null;n.useEffect(()=>{y&&r("/")},[y,r]);const[o,g]=n.useState({name:"",email:"",password:""}),p=a=>{const{name:i,value:l}=a.target;g(t=>({...t,[i]:l}))},F=async a=>{var i,l;a.preventDefault(),a.target.querySelectorAll("input").forEach(t=>t.blur());try{if(w(!0),s){let t=await h.post(`${u}/api/user/register`,{name:o.name,email:o.email,password:o.password,referralCode:v});t.data.success?(c.success(t.data.message),m(t.data.token),localStorage.setItem("token",t.data.token),g({name:"",email:"",password:""}),r("/"),r("/")):c.error(t.data.message)}else{let t=await h.post(`${u}/api/user/login`,{email:o.email,password:o.password});t.data.success?(c.success(t.data.message),m(t.data.token),localStorage.setItem("token",t.data.token),g({name:"",email:"",password:""}),r("/")):c.error(t.data.message)}}catch(t){console.log(t),c.error(((l=(i=t.response)==null?void 0:i.data)==null?void 0:l.message)||"Network error, please try again.")}finally{w(!1)}},P=async()=>{try{j(!0);const a=await q(U,$),{displayName:i,email:l,photoURL:t,uid:G}=a.user,x=await h.post(`${u}/api/user/google-auth`,{googleId:G,name:i,email:l,avatar:t,referralCode:v});x.data.success&&(m(x.data.token),localStorage.setItem("token",x.data.token),r("/"))}catch(a){console.log(a),c.error("Google login failed. Please try again.")}finally{j(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsxs("title",{children:[s?"Sign Up":"Login"," | E-commerce"]}),e.jsx("meta",{name:"description",content:s?"Create an account to start shopping on our E-commerce platform.":"Login to your E-commerce account to continue shopping."})]}),e.jsx("div",{className:"flex items-start justify-center min-h-screen pt-20 px-1 sm:px-0 ",children:e.jsxs(d.div,{className:"w-full max-w-sm p-6 rounded-xl text-gray-700",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(d.h2,{className:"text-xl font-bold mb-6 text-center",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.2},children:s?"Create Account":"Welcome Back"}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[s&&e.jsxs(d.div,{className:"relative",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:[e.jsx(z,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-indigo-400 group-focus-within:text-indigo-600 transition"}),e.jsx("input",{type:"text",name:"name",placeholder:"Full Name",required:!0,value:o.name,onChange:p,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-500 transition duration-200"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-indigo-400 group-focus-within:text-indigo-600 transition"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email",autoComplete:"email",required:!0,value:o.email,onChange:p,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-500 transition duration-200"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(T,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-indigo-400 group-focus-within:text-indigo-600 transition"}),e.jsx("input",{type:f?"text":"password",name:"password",placeholder:"Password",autoComplete:"current-password",required:!0,value:o.password,onChange:p,className:"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 rounded-lg shadow-sm outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-500 transition duration-200"}),e.jsx("button",{type:"button",onClick:()=>C(a=>!a),className:"absolute top-1/2 right-3 -translate-y-1/2 text-indigo-400 hover:text-indigo-600 transition",children:f?e.jsx(W,{}):e.jsx(B,{})})]}),e.jsx(d.button,{type:"submit",className:"w-full py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg hover:bg-indigo-500 transition",whileTap:{scale:.97},children:E?e.jsx(N,{size:20,color:"white"}):s?"Sign up":"Login"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:[s?"Already have an account?":"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>k(!s),className:"text-indigo-600 hover:underline font-medium",children:s?"Login":"Sign up"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("div",{className:"h-px bg-gray-300 flex-1"}),e.jsx("span",{className:"text-xs text-gray-400",children:"OR"}),e.jsx("div",{className:"h-px bg-gray-300 flex-1"})]}),e.jsxs("button",{type:"button",onClick:P,className:"w-full mt-4 py-2 flex items-center justify-center gap-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition",children:[!b&&e.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:b?e.jsx(N,{size:20}):"Continue with Google"})]})]})})]})};export{Y as default};
